<!doctype html>
<html lang="ja">

<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>J検索くん</title>
 <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->
 <style>

 </style>
</head>

<body>

 <!-- 検索フォーム -->
 <!-- <div class="row"> -->
     <!-- <div class="small-2 large-2 columns">検索ワード</div> -->
     <h1 for="email">検索ワード</h1>
     <div>
      <!-- class="small-4 large-4 columns" -->
       <!-- <input id="search-id" class="" type="text" placeholder="検索ワードを入力してください" /> -->
       <input id="yearFrom" type="number" min="2017" max="2019" step="1" value="2017" required>
       <a>年から</a>
       <input id="yearTo" type="number" min="2017" max="2019" step="1" value="2019" required>
       <a>年までで</a>
       <input id="continuou_recordFrom" type="number" min="2" max="15" step="1" value="2" required>
       <a>連勝以上</a>
       <input id="continuou_recordTo" type="number" min="2" max="15" step="1" value="15" required>
       <a>連勝以下</a>
       <a class="btn btn-default" onclick="loadUrl()">検索</a> 
     </div>
     
 
 <h2>検索結果</h2>
 <div id="main-block" class="row small-up-1 medium-up-2 large-up-3">
 </div>

 <script>
  const mainBlock = document.getElementById("main-block");

  function loadUrl() {

    while (mainBlock.firstChild) mainBlock.removeChild(mainBlock.firstChild);
    let yearFrom = "yearFrom=" + document.getElementById("yearFrom").value;
    let yearTo = "&yearTo=" + document.getElementById("yearTo").value;
    let continuou_recordFrom = "&continuou_recordFrom=" + document.getElementById("continuou_recordFrom").value;
    let continuou_recordTo = "&continuou_recordTo=" + document.getElementById("continuou_recordTo").value;
    let _url = "http://ec2-3-112-211-134.ap-northeast-1.compute.amazonaws.com:5000/continuous-records/match/win/?"+yearFrom+yearTo+continuou_recordFrom+continuou_recordTo;
    
    let xhttp = new XMLHttpRequest();
 
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) 
      {
        let res = JSON.parse(xhttp.responseText);
        console.log(res)
        // var hitcount = res.total_hit_count;
        for (let index = 0; index < res.data.length; index++) {
          let element = res.data[index];
          let node = document.createElement("div");
          node.innerHTML = element[1]+"年の"+element[4]+"節〜"+element[5]+"節　"+element[3]+"が"+element[6]+"連勝";
          mainBlock.appendChild(node);
        }
      }
    };
    // データ取得開始
    xhttp.open("GET", _url, true);
    xhttp.send();
  }
</script>
</body>

</html>